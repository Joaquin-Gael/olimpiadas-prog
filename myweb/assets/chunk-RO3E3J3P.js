import{m as l}from"./chunk-CK4HYLRU.js";import{$ as a,Ea as n,Qc as s,da as i}from"./chunk-HNZQVEQV.js";var g=class t{constructor(e,r){this.logger=r;this.isBrowser=s(e),this.logger.debug(`StorageService inicializado, isBrowser=${this.isBrowser}`)}memoryStorage=new Map;isBrowser;isRunningInBrowser(){return this.isBrowser}isLocalStorageAvailable(){if(!this.isBrowser)return this.logger.debug("localStorage no disponible: ejecutando en servidor"),!1;try{if(typeof window<"u"&&typeof window.localStorage<"u"){let e="__test__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),this.logger.debug("localStorage disponible en el navegador"),!0}return this.logger.debug("localStorage no definido en el navegador"),!1}catch(e){return this.logger.error("localStorage no accesible",e),!1}}setItem(e,r){try{let o=r.trim();this.isLocalStorageAvailable()?(window.localStorage.setItem(e,o),this.logger.debug(`Item ${e} guardado en localStorage: ${o.substring(0,20)}...`)):(this.memoryStorage.set(e,o),this.logger.debug(`Item ${e} guardado en memoria: ${o.substring(0,20)}...`))}catch(o){this.logger.error(`Error al guardar ${e} en almacenamiento`,o)}}getItem(e){try{if(this.isLocalStorageAvailable()){let o=window.localStorage.getItem(e);return o?(this.logger.debug(`Item ${e} recuperado de localStorage: ${o.substring(0,20)}...`),o):(this.logger.debug(`No se encontr\xF3 item en localStorage para la clave ${e}`),null)}let r=this.memoryStorage.get(e)||null;return r?this.logger.debug(`Item ${e} recuperado de memoria: ${r.substring(0,20)}...`):this.logger.debug(`No se encontr\xF3 item en memoria para la clave ${e}`),r}catch(r){return this.logger.error(`Error al obtener ${e} del almacenamiento`,r),null}}removeItem(e){try{this.isLocalStorageAvailable()?(window.localStorage.removeItem(e),this.logger.debug(`Item ${e} eliminado de localStorage`)):(this.memoryStorage.delete(e),this.logger.debug(`Item ${e} eliminado de memoria`))}catch(r){this.logger.error(`Error al eliminar ${e} del almacenamiento`,r)}}setObject(e,r){try{let o=JSON.stringify(r);this.setItem(e,o)}catch(o){this.logger.error(`Error al guardar objeto ${e} en almacenamiento`,o)}}getObject(e){try{let r=this.getItem(e);return r?JSON.parse(r):null}catch(r){return this.logger.error(`Error al obtener objeto ${e} del almacenamiento`,r),null}}setToken(e){let r=e.trim();this.memoryStorage.set("access_token",r),this.isLocalStorageAvailable()?(window.localStorage.setItem("access_token",r),this.logger.debug(`Token guardado en localStorage y memoria: ${r.substring(0,20)}...`)):this.logger.debug(`Token guardado en memoria: ${r.substring(0,20)}...`)}getToken(){let e=this.memoryStorage.get("access_token");if(e)return this.logger.debug(`Token recuperado de memoria: ${e.substring(0,20)}...`),e;if(this.isLocalStorageAvailable()){let r=window.localStorage.getItem("access_token");if(r)return this.logger.debug(`Token recuperado de localStorage: ${r.substring(0,20)}...`),this.memoryStorage.set("access_token",r),r}return this.logger.debug("No se encontr\xF3 token en ning\xFAn medio"),null}removeToken(){this.removeItem("access_token")}setRefreshToken(e){this.setItem("refresh_token",e)}getRefreshToken(){return this.getItem("refresh_token")}removeRefreshToken(){this.removeItem("refresh_token")}getRememberEmail(){return this.getItem("rememberEmail")}clearStorage(){try{this.removeToken(),this.removeRefreshToken(),this.removeItem("rememberEmail"),this.removeItem("carrito"),this.removeItem("viajePersonalizado"),this.logger.debug("Almacenamiento limpiado correctamente")}catch(e){this.logger.error("Error al limpiar almacenamiento",e)}}static \u0275fac=function(r){return new(r||t)(i(n),i(l))};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};export{g as a};
