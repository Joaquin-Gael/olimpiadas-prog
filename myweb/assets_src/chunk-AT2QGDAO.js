import{e as y,m as U}from"./chunk-RGOLDJ7I.js";import{$ as b,E as s,Q as l,T as g,W as n,Y as h,da as c,l as m,p as o,s as p,t as u}from"./chunk-JIXPPSV7.js";var t={production:!0,apiBaseUrl:"https://olimpiadas-prog.onrender.com",wsBaseUrl:"ws://olimpiadas-prog.onrender.com",apiTimeout:1e4,retryAttempts:3,retryDelay:1e3};var E=class d{constructor(r,e){this.http=r;this.logger=e;this.fetchUuid()}baseUrl=t.apiBaseUrl;baseWsUrl=t.wsBaseUrl;uuidSubject=new m(1);uuid$=this.uuidSubject.asObservable();uuidLoaded$;fetchUuid(){this.uuidLoaded$=this.http.get(`${this.baseUrl}/id_prefix_api_secret/`).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}),h(r=>{let e=r.id_prefix_api_secret;if(!e||typeof e!="string"||e.trim()==="")throw new Error("UUID inv\xE1lido recibido del servidor");this.logger.debug("UUID fetched",{uuid:e}),this.uuidSubject.next(e)}),u(r=>r.id_prefix_api_secret),s(r=>(this.logger.error("Error fetching UUID",r),o(()=>new Error("No se pudo cargar el UUID de la API")))),g(1)),this.uuidLoaded$.subscribe({error:r=>this.logger.error("UUID loading failed",r)})}buildUrl(r){return this.uuidLoaded$.pipe(u(e=>{let i=r.replace(/^\/+/,"");return`${this.baseUrl}/${e}/${i}`}),s(e=>(this.logger.error("Error building URL",e),o(()=>new Error("Error al construir la URL de la API")))))}buildWsUrl(r){return this.uuidLoaded$.pipe(u(e=>{let i=r.replace(/^\/+|\/+$/g,"");return`${this.baseWsUrl}/${e}/${i}`}),s(e=>(this.logger.error("Error building WebSocket URL",e),o(()=>new Error("Error al construir la URL de WebSocket")))))}generateUUIDv4(){return crypto.randomUUID()}get(r,e){return this.buildUrl(r).pipe(n(i=>this.http.get(i,e).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}))),s(i=>(this.logger.error(`Error in GET ${r}`,i),o(()=>new Error(`Error al obtener datos de ${r}`)))))}post(r,e,i){return this.buildUrl(r).pipe(n(a=>this.http.post(a,e,i).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}))),s(a=>(this.logger.error(`Error in POST ${r}`,a),o(()=>new Error(`Error al enviar datos a ${r}`)))))}put(r,e,i){return this.buildUrl(r).pipe(n(a=>this.http.put(a,e,i).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}))),s(a=>(this.logger.error(`Error in PUT ${r}`,a),o(()=>new Error(`Error al actualizar datos en ${r}`)))))}delete(r,e){return this.buildUrl(r).pipe(n(i=>this.http.delete(i,e).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}))),s(i=>(this.logger.error(`Error in DELETE ${r}`,i),o(()=>new Error(`Error al eliminar datos en ${r}`)))))}patch(r,e,i){return this.buildUrl(r).pipe(n(a=>this.http.patch(a,e,i).pipe(p(t.apiTimeout),l({count:t.retryAttempts,delay:t.retryDelay}))),s(a=>(this.logger.error(`Error in PATCH ${r}`,a),o(()=>new Error(`Error al modificar datos en ${r}`)))))}static \u0275fac=function(e){return new(e||d)(c(y),c(U))};static \u0275prov=b({token:d,factory:d.\u0275fac,providedIn:"root"})};export{t as a,E as b};
